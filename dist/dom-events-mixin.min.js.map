{"version":3,"file":"dom-events-mixin.min.js","sources":["../node_modules/object-assign/index.js","../src/lib/keyfrom.js","../src/lib/event_registry.js","../src/index.js","../node_modules/matches-selector/index.js","../src/lib/keynames.js"],"sourcesContent":["/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","import keynames from './keynames.js';\n\nexport default function keyFrom(event){\n\n    if(event.key !== void 0){\n        return event.key.toLowerCase();\n    }\n\n    return (keynames[event.which]\n        || String.fromCharCode(event.keyCode).toLowerCase());\n}\n","import matches from 'matches-selector';\nimport keyFrom from './keyfrom.js';\n\nexport function registerEvent(source, name){\n    source._events = source._events || {};\n    source._events[name] = source._events[name] || [];\n}\n\nfunction initInfo(name){\n    const info = {keys: null, name};\n    let keys, names;\n    let maybeKeys = name.split(':').map(s=>s.trim());\n    if(maybeKeys.length > 1){\n        let map = {}, index;\n        [keys, names] = maybeKeys;\n        let list = keys.split('+');\n        const setOp = (name)=>{\n            if((index = list.indexOf(name)) !== -1){\n                map[name] = true;\n                map.operators = true;\n                list.splice(index, 1);\n            }\n\n        };\n        setOp('ctrl');\n        setOp('alt');\n        setOp('shift');\n        setOp('cmd');\n        map.key = list[0];\n        info.keys = map;\n        info.names = names.split(' ');\n        map.controls = function(event){\n            return ((event.ctrlKey || undefined) == map.ctrl &&\n            (event.altKey || undefined) == map.alt &&\n            (event.shiftKey || undefined) == map.shift);\n        };\n        if(typeof map.cmd === 'boolean'){\n            //supporting ctrl and meta for mac\n            map.controls = function(event){\n                return ((event.ctrlKey || event.metaKey) &&\n                (event.altKey || undefined) == map.alt &&\n                (event.shiftKey || undefined) == map.shift);\n            };\n        }\n    }else{\n        info.names = name.split(' ');\n    }\n\n    return info;\n}\n\nexport function getEventInfo(name, delegate, listener, options){\n\n    let userListener = listener;\n    let source = this;\n    let info = initInfo(name);\n\n    if(typeof delegate !== 'string'){\n        //useCapture = listener;\n        options = listener;\n        userListener = listener = delegate;\n        delegate = null;\n    }\n\n    options = options || {};\n\n    let { once, useCapture = false, throttle, debounce } = options;\n\n    //Last caller is created first\n    //All layered like an onion from the inside out on creation\n    //Pealed from the outside in on event firing\n    if(once){\n        listener = ((fire)=>{\n            return function(event){\n                removeEvent(source, info);\n                return fire.call(this, event);\n            };\n        })(listener);\n    }\n\n    if(typeof delegate === 'string'){\n        listener = ((fire)=>{\n            return function(event){\n                if(matches(event.target, delegate)){\n                    return fire.call(this, event);\n                }\n            };\n        })(listener);\n    }\n\n    if(info.keys){\n        listener = ((fire, map)=>{\n            return function(event){\n                //Some times a visible key is used\n                if(!map.key || map.key === keyFrom(event)){\n\n                    if(map.controls(event)){\n                        return fire.call(this, event);\n                    }\n                }\n            };\n        })(listener, info.keys);\n    }\n\n    if(debounce){\n        listener = ((fire, delay)=>{\n            let timer = null;\n            return function(event){\n                clearTimeout(timer);\n                timer = setTimeout(()=>{\n                    fire.call(this, event);\n                }, delay);\n            };\n        })(listener, parseInt(debounce));\n    }else\n\n    if(throttle){\n\n        listener = ((fire, wait)=>{\n            var ctx, args, rtn, timeoutID; // caching\n            var last = 0, first = false;\n\n            const reset = ()=>{\n                timeoutID = 0;\n                last = Date.now();\n            };\n\n            return function(event){\n                //ctx = this;\n                //args = arguments;\n                if(!first){\n                    first = true;\n                    reset();\n                    fire.call(this, event);\n                    return;\n                }\n                let delta = new Date() - last;\n                if (!timeoutID){\n                    if(delta >= wait){\n                        reset();\n                        rtn = fire.call(this, event);\n                    }else{\n                        timeoutID = setTimeout(()=>{\n                            reset();\n                            rtn = fire.call(this, event);\n                        }, wait - delta);\n                    }\n                }\n                return rtn;\n            };\n        })(listener, throttle);\n\n    }\n\n    return Object.assign(info, {\n        listener,\n        userListener,\n        useCapture,\n        delegate\n    });\n}\n\nexport function addEvent(source, event){\n    source._events[event.name].push(event);\n    event.names.forEach(name=>{\n        source.element.addEventListener(name, event.listener, event.useCapture);\n    });\n}\n\nexport function removeEvent(source, event){\n    if(source._events === void 0) return;\n    if(source._events[event.name] === void 0) return;\n\n    let events = source._events[event.name];\n\n    for(let i=0; i<events.length; i++){\n        if(events[i].userListener === event.userListener){\n            events[i].names.forEach(name=>{\n                source.element.removeEventListener(\n                    name, event.listener, event.useCapture);\n            });\n\n            source._events[event.name].splice(i, 1);\n            if(!source._events[event.name].length){\n                delete source._events[event.name];\n            }\n            return;\n        }\n    }\n}\n","import objectAssign from 'object-assign';\nimport {\n    getEventInfo,\n    registerEvent,\n    addEvent,\n    removeEvent\n} from './lib/event_registry.js';\n\nconst props = {\n    _delegated: [],\n    on(name, delegate, listener, options){\n        const info = getEventInfo.apply(null, arguments);\n        registerEvent(this, name);\n        addEvent(this, info);\n    },\n    off(name, delegate, listener, options){\n        const info = getEventInfo.apply(null, arguments);\n        removeEvent(this, info);\n    },\n    once(name, delegate, listener, options){\n        if(typeof delegate === 'function'){\n            listener = delegate;\n            options = listener;\n        }\n        options = options || {};\n        options.once = true;\n        const info = getEventInfo.call(this, name, delegate, listener, options);\n        registerEvent(this, name);\n        addEvent(this, info);\n    },\n    matches(selector){\n        return matches(this.element, selector);\n    },\n    observe(event){\n        //This is here to remind us that native observables\n        //are on the horizon.\n        /*\n        return new Observable(observer=>{\n            //using events from this prototype\n            //emit the observable value\n        });\n        */\n    }\n};\n\nexport function mixin(dest){\n    objectAssign(dest, props);\n    return dest;\n}\n\nexport function mixinDOMEvents(dest){\n    return mixin(dest);\n}\n\nexport { props };\n\nfunction hasDelegate(args){\n    return (typeof args[1] === 'string'\n    && typeof args[2] === 'function');\n}\n","'use strict';\n\nvar proto = typeof Element !== 'undefined' ? Element.prototype : {};\nvar vendor = proto.matches\n  || proto.matchesSelector\n  || proto.webkitMatchesSelector\n  || proto.mozMatchesSelector\n  || proto.msMatchesSelector\n  || proto.oMatchesSelector;\n\nmodule.exports = match;\n\n/**\n * Match `el` to `selector`.\n *\n * @param {Element} el\n * @param {String} selector\n * @return {Boolean}\n * @api public\n */\n\nfunction match(el, selector) {\n  if (!el || el.nodeType !== 1) return false;\n  if (vendor) return vendor.call(el, selector);\n  var nodes = el.parentNode.querySelectorAll(selector);\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i] == el) return true;\n  }\n  return false;\n}\n","const keynames = {\n  8   : 'backspace',\n  9   : 'tab',\n  13  : 'enter',\n  16  : 'shift',\n  17  : 'ctrl',\n  18  : 'alt',\n  20  : 'capslock',\n  27  : 'esc',\n  32  : 'space',\n  33  : 'pageup',\n  34  : 'pagedown',\n  35  : 'end',\n  36  : 'home',\n  37  : 'left',\n  38  : 'up',\n  39  : 'right',\n  40  : 'down',\n  45  : 'ins',\n  46  : 'del',\n  91  : 'meta',\n  93  : 'meta',\n  224 : 'meta'\n};\n\nexport default keynames;\n"],"names":["toObject","val","undefined","TypeError","Object","keyFrom","event","key","toLowerCase","keynames","which","String","fromCharCode","keyCode","registerEvent","source","name","_events","initInfo","const","keys","names","info","maybeKeys","split","map","s","trim","length","let","index","list","setOp","indexOf","operators","splice","controls","ctrlKey","ctrl","altKey","alt","shiftKey","shift","cmd","metaKey","getEventInfo","delegate","listener","options","userListener","this","once","throttle","debounce","fire","removeEvent","call","matches","target","delay","timer","clearTimeout","setTimeout","parseInt","wait","rtn","timeoutID","last","first","reset","Date","now","delta","assign","useCapture","addEvent","push","forEach","element","addEventListener","events","i","removeEventListener","mixin","dest","objectAssign","props","getOwnPropertySymbols","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","test1","getOwnPropertyNames","test2","n","join","test3","letter","err","shouldUseNative","from","symbols","to","arguments","proto","Element","vendor","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","el","selector","nodeType","nodes","parentNode","querySelectorAll","8","9","13","16","17","18","20","27","32","33","34","35","36","37","38","39","40","45","46","91","93","224","_delegated","on","apply","off","observe"],"mappings":"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"}