{"version":3,"file":"bundle.es.js","sources":["../src/lib/event_registry.js","../src/index.js"],"sourcesContent":["import matches from 'matches-selector';\nimport objectAssign from 'object-assign';\n\nexport function registerEvent(source, name){\n    source._events = source._events || {};\n    source._events[name] = source._events[name] || [];\n}\n\nfunction initInfo(name){\n    const info = {name};\n    info.names = name.trim().split(/[ ]+/);\n    return info;\n}\n\nconst layers = {\n    delegate(fire, delegate){\n        return function(event){\n            if(matches(event.target, delegate)){\n                return fire.call(this, event);\n            }\n        };\n    },\n    debounce(fire, delay){\n        let timer = null;\n        return function(event){\n            clearTimeout(timer);\n            timer = setTimeout(()=>{\n                fire.call(this, event);\n            }, delay);\n        };\n    },\n    throttle(fire, wait){\n        let rtn, last = 0, first = false, timeoutID;\n\n        const reset = ()=>{\n            timeoutID = 0;\n            last = Date.now();\n        };\n\n        return function(event){\n            let delta = new Date() - last;\n\n            if(!first){\n                first = true;\n                reset();\n                fire.call(this, event);\n                return;\n            }\n\n            if(!timeoutID){\n                if(delta >= wait){\n                    reset();\n                    rtn = fire.call(this, event);\n                }else{\n                    timeoutID = setTimeout(()=>{\n                        reset();\n                        rtn = fire.call(this, event);\n                    }, wait - delta);\n                }\n            }\n            return rtn;\n        };\n    },\n    contain(fire){\n        return function(event){\n\n            let rect = this.getBoundingClientRect();\n            if (event.clientX >= rect.left\n                && event.clientX <= rect.right\n                && event.clientY >= rect.top\n                && event.clientY <= rect.bottom) {\n              // Mouse is inside element.\n              return fire.call(this, event);\n            }\n        };\n    },\n    once(source, fire, info){\n        return function(event){\n            removeEvent(source, info);\n            return fire.call(this, event);\n        };\n    },\n    object(handler){\n        return function(event){\n            return (handler.handleEvent).call(handler, event);\n        };\n    }\n};\n\nexport function getEventInfo(name, delegate, handler, options){\n\n    let userHandler = handler;\n    let source = this;\n    let info = initInfo(name);\n\n    if(typeof delegate !== 'string'){\n        options = handler;\n        userHandler = handler = delegate;\n        delegate = null;\n    }\n\n    let {\n        once, capture = false, throttle = 0, debounce = 0\n    } = typeof options === 'object' ? options : {};\n\n    //Last caller is created first\n    //All layered like an onion from the inside out on creation\n    //Pealed from the outside in on event firing\n\n    if(typeof handler === 'object'){\n        if(typeof handler.handleEvent !== 'object'){\n            throw new TypeError(\n                handler.handleEvent + ' on ' + handler +\n                ' is not a function'\n            );\n        }\n\n        handler = layers.object(handler);\n    }\n\n    //Prefer throttle over debounce\n    if(throttle && !(throttle !== throttle)){\n        handler = layers.throttle(handler, parseInt(throttle));\n    }else\n    if(debounce && !(debounce !== debounce)){\n        handler = layers.debounce(handler, parseInt(debounce));\n    }\n\n    //once runs before async layers,\n    //and after sync layers\n    if(!!once){\n        handler = layers.once(source, handler, info);\n    }\n\n    if(typeof delegate === 'string'){\n        try{\n            document.querySelector(delegate);\n        }catch(e){\n            throw new Error('delegate selector Error \\n'+e.message);\n        }\n        handler = layers.delegate(handler, delegate);\n    }\n\n    return objectAssign(info, {\n        handler,\n        //Matching properties for removal\n        userHandler,\n        capture,\n        delegate,\n        throttle,\n        debounce\n    });\n}\n\nexport function addEvent(source, event){\n    source._events[event.name].push(event);\n    event.names.forEach(name=>{\n        source.element.addEventListener(name, event.handler, event.capture);\n    });\n}\n\nexport function removeEvent(source, event){\n    if(source._events === void 0) return;\n    if(source._events[event.name] === void 0) return;\n\n    let events = source._events[event.name];\n\n    for(let i=0; i<events.length; i++){\n        if(\n            events[i].userHandler === event.userHandler &&\n            events[i].capture === event.capture &&\n            events[i].delegate === event.delegate &&\n            events[i].throttle === event.throttle &&\n            events[i].debounce === event.debounce\n        ){\n            events[i].names.forEach(name=>{\n                source.element.removeEventListener(\n                    name, event.handler, event.capture);\n            });\n\n            source._events[event.name].splice(i, 1);\n            if(!source._events[event.name].length){\n                delete source._events[event.name];\n            }\n            return;\n        }\n    }\n}\n","import objectAssign from 'object-assign';\nimport {\n    getEventInfo,\n    registerEvent,\n    addEvent,\n    removeEvent\n} from './lib/event_registry.js';\n\nconst props = {\n    _delegated: [],\n    on(name, delegate, listener, options){\n        const info = getEventInfo.apply(null, arguments);\n        registerEvent(this, name);\n        addEvent(this, info);\n        return this;\n    },\n    off(name, delegate, listener, options){\n        const info = getEventInfo.apply(null, arguments);\n        removeEvent(this, info);\n        return this;\n    },\n    once(name, delegate, listener, options){\n        if(typeof delegate === 'function'){\n            listener = delegate;\n            options = listener;\n        }\n        options = options || {};\n        options.once = true;\n        const info = getEventInfo.call(this, name, delegate, listener, options);\n        registerEvent(this, name);\n        addEvent(this, info);\n        return this;\n    },\n    matches(selector){\n        return matches(this.element, selector);\n    },\n    dispatch(event){\n        element.dispatchEvent(event);\n    },\n    observe(event){\n        //This is here to remind us that native observables\n        //are on the horizon.\n        /*\n        return new Observable(observer=>{\n            //using events from this prototype\n            //emit the observable value\n        });\n        */\n    }\n};\n\n[\n    'click',\n    'focus',\n    'blur'\n].forEach(prop=>{\n    props[prop] = function(){\n        return this.element[prop]();\n    };\n});\n\nexport function mixin(dest){\n    objectAssign(dest, props);\n    return dest;\n}\n\nexport function mixinDOMEvents(dest){\n    return mixin(dest);\n}\n\nexport { props };\n"],"names":["const","delegate","matches","let","this"],"mappings":"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"}